# File Explorer

## Feature
### 文件浏览
* 正常的目录浏览
  * 配置文件中可以设置根目录，默认为/目录
  * 点击文件Tab工具栏“💻”按钮，调用默认文件浏览器打开当前目录
  * 软件界面左上角输入栏支持输入绝对路径打开目录
* 目录树浏览
  * 单机展开子目录，双击创建新Tab打开目录
* 收藏夹
  * 文件Tab根据当前目录是否已收藏，工具栏显示"收藏/取消收藏"按钮
  * 每个收藏目录也是一棵目录树，单击展开子目录，双击打开目录
  * 打开收藏夹时检测收藏目录是否存在，存在失效目录时提示删除
    * 配置文件内提供 提示(0，默认)/直接删除(1)/忽略(2) 3种选项

### 文件Extra Info
> Windows自带的文件浏览器支持给文件添加很多类型的属性，但存在下面的问题
>> - 仅支持媒体文件，不支持其他类型的文件或目录
>> - 对只读文件无法修改属性
>> - 删除属性时会将文件拷贝一遍，大文件操作效率低
> - 考虑到以上因素，本工具选择外嵌的方式为文件添加属性信息，打开目录后加载展示

* 属性类型
  * 评分：不限正负（就是int32）
  * 标签：支持添加多个描述性词语，浏览时可根据标签过滤
  * 备注：长文本，最高300字
  * URL：地址，设置后可点击"打开url"按钮，调用默认浏览器批量打开被选文件url
    * 支持文件名通配符"{name}"
    * 目前文件列表中不显示该属性
  
  *注意，标签和备注可能因为过长被省略，双击对应cell可完整显示*
  

* 存储
  * 位置
    * 根目录extra info保存在软件目录/.fe_meta_data下
    * 其他目录extra info保存在同目录/.fe_meta_data下
  * 文件：yml文本文件，文件名extra_info.{timestamp}.yml
  

* 编辑方式（*也可以手动修改yml文件内容*）
  * 进入目录后选中待修改文件，点击"编辑ExtraInfo"按钮，进入批量编辑页
  * 预览列表选中项目后，编辑输入栏修改，预览列表同步显示修改后内容
    * “标签”属性输入后还需要回车才能添加，双击已添加标签可删除
    * 输入栏同步显示被选中项目聚合值，*表示选中项对应属性存在多个值
  * 点击"Cancel"按钮还原被选项目
  * 点击"Submit"按钮提交所有项目改动，提交时创建新yml文件存储
  * 点击"还原"按钮显示目录下历史yml文件(显示修改时间)，单击载入
  
  
    
### fix日志
#### v0.1
* fyne文本组件bind listener监听输入内容改动有bug
  * 使用onChange触发后解决
* fyne label内容包含换行时显示修复
  * 显示时替换为"\n"
* fyne最小化窗口时越界问题
  * 改动container后解决
* 中文排序优化
  * golang默认使用unicode排序
  * 中文字符按拼音排序
  
  

## Run
* windows下执行build.cmd，mac下执行build.sh打包应用，运行
  * gui用fyne编写，理论上也可以修改-os参数打包成安卓/ios应用
* 配置文件
  * win: .exe所在目录/conf.yml
  * linux: ~/.fe_config/conf.yml

## Arch
```
file_explorer
├─common
│  ├─logger                 日志api
│  ├─model                  结构体
│  └─utils                  工具api
├─resource                  静态资源
│  ├─font                   字体
│  └─picture                图片
├─service                   服务层
├─test                      测试
└─view                      视图
    ├─components            文件浏览器组件
    │  ├─main_panel         窗口主面板
    │  │  ├─extra_info_tab  ExtraInfo Tab
    │  │  └─file_tab        文件Tab
    │  └─side_panel         窗口侧边栏
    ├─packed_widgets        fyne原生widget修改版
    └─store                 上下文数据
```

## TODO
* 版本更新提示
* 文件搜索
* ExtraInfo历史文件过多时清理提示
* 文件操作
  * 批量重命名
  * 创建、复制、移动等常用操作
* 文件运行
  * call第三方程序打开文件
* 组件尺寸优化